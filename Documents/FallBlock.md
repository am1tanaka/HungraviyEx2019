# 落下するブロック
ぐらびぃが乗ると落下するブロック。他のオブジェクトは大丈夫。

## 落下前
落下前は、外部の物理的な影響を無視しつつ、当たり判定は有効にしておきたいので、Rigidbody2Dの設定を以下のようにする。

- *Simulated*にチェック
  - これをしないとすり抜ける
- *Gravity Scale*を0.25程度に設定
  - ぐらびぃより落下を遅くして、崩壊中は落下しつつも、ぐらびぃの回復ができるようにする
- *Body Type*を*Kinematic*
  - これにより、敵などとぶつかっても動かなくなる

回転は不要なので、Z回転をFreezeしておく。

## アニメ作成
アニメは以下の状態が存在する。

- 待機時
  - 当たり判定あり
  - デフォルトのパターンが表示されている
- 落下時
  - 当たり判定あり
  - 崩壊アニメを再生。戻す必要がないのでトリガーでよい
  - Body Typeを*Dynamic*に変更

落下アニメが終わったら、オブジェクトを削除する。

## 衝突時処理
動作はブロック側で完結できるので、FallBlockスクリプトを作成してアタッチする。必要な処理は以下の通り。

- Animatorを取得しておく
- 衝突があったら、相手がPlayerかどうかと、Body TypeがKinematicかを判定。成立していたら以下を処理
  - 崩壊アニメを開始する
  - Body TypeをDynamicに変更
  - アニメの再生が完了する時間の経過後に削除する予約
